---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getTagIndex } from '../../lib/tagIndex';
import FilterBar from '../../components/FilterBar.astro';
import { registerFilterList } from '../../lib/filterList';

const tags = await getTagIndex();

registerFilterList({ inputId: 'tags-filter', itemSelector: '#tags-list [data-filter-text]', emptyId: 'tags-empty' });
---

<BaseLayout title="Tags" description="Browse by tag.">
	<h1 class="text-2xl font-bold tracking-tight">Tags</h1>
	<p class="mt-2 text-muted-foreground">Browse posts and projects by topic.</p>

	<FilterBar id="tags-filter" placeholder="Filter tags" />

	<ul class="mt-6 flex flex-wrap gap-2" id="tags-list">
		{tags.map((t) => (
			<li data-filter-text={`${t.label ?? ''} ${t.slug ?? ''}`.toLowerCase()}>
				<a
					href={`/tags/${t.slug}`}
					class="inline-flex items-center rounded-md border border-border bg-background px-2 py-1 text-sm no-underline hover:bg-accent hover:text-accent-foreground"
				>
					{t.label}
					<span class="ml-2 rounded-sm bg-muted px-1.5 py-0.5 text-xs text-muted-foreground">{t.count}</span>
				</a>
			</li>
		))}
	</ul>

	<p id="tags-empty" class="mt-6 hidden text-sm text-muted-foreground">No matches.</p>
</BaseLayout>
